# Swagger:
You can access to REST api at url `<backend:7771>/api/swagger`

# Web Socket Communications:
Url for bringing up a websocket connection is:
`wss://<backend:7771>/api/v1/run/events/{containerid}` 

Where `containerid` is the alphanumeric id that is sent in response to a `/run/new` REST call.

More that one client can be connected to one container: the input to that instance will be the sum of all inputs, while the output will be fanned out to all clients.

## Client message format
Once the communication is established, the client can send JSON messages in this format:
```json
{
	"line": "line entered by the user\n",
	"cmd":"out of band commands",
}
```
Each parameter can be missing if empty not relevant. First one ("line") is the line interactively sent by the user. Eventual control characters,such as newlines `\n`, **must** be explicitly sent by the client.

So a bash command to list files should be:
```json
{"line":"ls\n"}
```

To send out-of-band commands, client can use "cmd" parameter. At the moment, the only supported command is "dump", which will provide the immudb tree.

## Server message format
Server will produce JSON messages in this format
```json
{
	"timestamp": 1617367545.01234,
	"flux": "stdin|stdout",
	"line": "interactive output",
	"tree": "base64encoded tree representation",
}
```

"timestamp" is of course the epoch in which the message is created, flux can be `stdin` or `stdout` and "line" contains the output generated by the live container, usually (but not necessarily) in response to a user input. 

"tree" contains the base64-encoded representation of the tree status, in the same way used in the non-interactive containers.

Flux, line and tree can be omitted if empty or not relevant: usually container output doesn't have "tree" values. Out-of-band commands, instead, have no "flux" or "line" fields.
